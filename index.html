<!DOCTYPE html>
<html>
<head>
  <title>AR Venue Navigation</title>
  <script src="https://aframe.io/releases/1.0.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/jeromeetienne/AR.js/2.2.2/aframe/build/aframe-ar.js"></script>
</head>
<body style='margin: 0px; overflow: hidden;'>
  <a-scene embedded arjs>
    <!-- Camera Component -->
    <a-camera gps-new-camera></a-camera>

    <!-- Marker 1 -->
    <a-marker id="marker1" gps-new-entity-place="latitude: <latitude_1>; longitude: <longitude_1>">
      <!-- AR Element for Marker 1 -->
      <a-entity position="0 0.1 0">
        <a-text value="Location 1" color="white" align="center"></a-text>
      </a-entity>
    </a-marker>

    <!-- Direction Indicators -->
    <a-entity id="directionIndicator" position="0 1 -5" text="value: Go Here; color: red; align: center;"></a-entity>

    <!-- Handle events or interactions here -->
  </a-scene>

  <script>
    var cameraEl = document.querySelector('a-camera');

    // Get user's GPS location
    navigator.geolocation.getCurrentPosition(function(position) {
      var userLat = position.coords.latitude;
      var userLon = position.coords.longitude;

      // Calculate distance and bearing for Marker 1
      var marker1Lat = parseFloat(document.getElementById('marker1').getAttribute('gps-new-entity-place').latitude);
      var marker1Lon = parseFloat(document.getElementById('marker1').getAttribute('gps-new-entity-place').longitude);
      var bearingToMarker1 = calculateBearing(userLat, userLon, marker1Lat, marker1Lon);

      // Display directional indicator
      if (bearingToMarker1 !== null) {
        var directionIndicator = document.getElementById('directionIndicator');
        directionIndicator.setAttribute('rotation', '0 ' + bearingToMarker1 + ' 0');
        directionIndicator.setAttribute('visible', 'true');
      }

      // Rotate directional indicator based on device orientation
      window.addEventListener('deviceorientation', function(event) {
        var alpha = event.alpha; // Rotation around the z-axis (in degrees)
        var beta = event.beta; // Rotation around the x-axis (in degrees)
        var gamma = event.gamma; // Rotation around the y-axis (in degrees)

        // Adjust rotation of direction indicator based on device orientation
        var rotationY = gamma; // Adjust according to your device's orientation axis
        directionIndicator.setAttribute('rotation', '0 ' + rotationY + ' 0');
      });
    });

    // Function to calculate bearing between two GPS coordinates
    function calculateBearing(lat1, lon1, lat2, lon2) {
      var dLon = deg2rad(lon2 - lon1);
      var y = Math.sin(dLon) * Math.cos(deg2rad(lat2));
      var x = Math.cos(deg2rad(lat1)) * Math.sin(deg2rad(lat2)) -
              Math.sin(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.cos(dLon);
      var brng = Math.atan2(y, x);
      brng = brng * (180 / Math.PI); // Convert bearing from radians to degrees
      brng = (brng + 360) % 360; // Normalize to 0-360 degrees
      return brng;
    }

    function deg2rad(deg) {
      return deg * (Math.PI / 180);
    }
  </script>
</body>
</html>



